
Results (time measurements on Josh's desktop):

- Cracking rockyou-test-1mil.md5.txt using input rockyou-train-100k.txt
  - best64.rule: 0:25, 31.70%, 64 rules
  - dive.rule: 1:08, 83.84%, 99092 rules
  - oneruletorulethemall.rule: 1:02, 86.80%, 52014 rules
  - ours w/ english dictionary: 0:49, 64.04%, 21597 rules

- Cracking pwned-passwords-sha1-ordered-by-count-v8.top1mil.txt using input rockyou-train-100k.txt
  - no rules: 0:10, 9.82%, 0 rules
  - best64.rule: 0:33, 41.52%, 64 rules
  - dive.rule: 1:00, 82.98%, 99092 rules
  - oneruletorulethemall.rule: 1:04, 84.68%, 52014 rules
  - ours w/ english dictionary: 0:55, 70.45%, 36198 rules

- Cracking pwned-passwords-sha1-ordered-by-count-v8.top100mil.txt using input rockyou-train-100k.txt
  - hashcat's generated.rule:
  - oneruletorulethemall.rule: 49:58, 30.87%, 52014 rules
  - ours w/ english dictionary: 24:25, 14.56%, 36198 rules


neo4j:

git clone https://github.com/majensen/libneo4j-client.git libneo4j-client-v4
cd libneo4j-client-v4
./autogen.sh
./configure --prefix=`pwd`/../libneo4j-client-v4-install --disable-tools --disable-werror
make install

docs: https://neo4j-client.net/doc/latest/neo4j-client_8h.html

Add to hashcat Makefile:

NEO4J_FLAGS=$(shell PKG_CONFIG_PATH=../libneo4j-client-v4-install/lib/pkgconfig/ pkg-config --cflags --libs neo4j-client)
gengraph: gengraph.c obj/combined.LINUX.a
	$(CC_LINUX) $(CCFLAGS) $(CFLAGS_NATIVE) $(LFLAGS_NATIVE) $(NEO4J_FLAGS) -g -o gengraph gengraph.c obj/combined.LINUX.a


Procedure:

- start with initial list of passwords
- run hashcat -stdout with set of rules (say, base64)
- make graph edge between every input password and resulting password and the applied rule
- repeat for every node in the resulting graph, though tacking care not to use a rule on a password again (i.e., where an edge already exists)

- track which rules and which passwords are being successful (matching something from the original passwords list; use a hashmap to find out), and prefer those (how?)
  - make a priority queue so successful passwords/rules are explored earlier?


Run:
LD_LIBRARY_PATH=../libneo4j-client-v4-install/lib/ ./gengraph ../passwords.txt rules/best64.rule

